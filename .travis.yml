language: node_js
node_js:
    - '8'
    - '7'
    - '6'
sudo: required
dist: trusty
services:
    - docker
addons:
    code_climate:
        repo_token: $CODE_CLIMATE_TOKEN
branches:
    only:
        - master
        - development
        - /^release-.*$/
        - /^hotfix-.*$/
before_install:
    - sudo apt-get install xvfb
install:
    - export DISPLAY=':99.0'
    - Xvfb :99 -screen 0 1024x768x24 > /dev/null 2>&1 &
    - docker pull auvsisuas/interop-server
    - docker images
    - npm install
    - npm install -g mocha
script:
    - npm run test-travis
after_success:
    - npm install -g codeclimate-test-reporter
    - codeclimate-test-reporter < coverage/lcov.info
notifications:
    email: false
    slack:
        rooms:
            secure: cL3zNC1J8f/hlRD9kQIglRexCI51Ud8fQ3bX9so2MIpDScXWvSoJtkNEnJLWO50+iLlsjwnQAXo+v3k8U3HP+jaFHDBBrmViQFQKYVHg+PeKX31eNZKVnHsgTxEHFtYtaxphdlspa1MZfX7uXrgoWiL3gGggNzN264SdOv8x2jPK5b/bpKPVZpU0yHwEZ8SwZki/p78n+vhJGnO1NHejVNQ3d4DzkqIUkqHKr42KohtZGpHd/uAzmIGykKyn0BBwpTOyUfdU985tG7f423KZDIvJsLETY5BJxMImNMghiQauFYm3sSTi5Qf0PuV1WSltvPJP0Xgh+uLrxFLEbVNt17JPz9sFedCHMO4RvCjp0T1uoNBXy5+uqBxOIGxMDPiqUlho6IL0YGpJ29hGcFbVugnGdpqfrEegrUXUOXVuyFt7lYcskqyAClBvbzwp+C9dk3MeXfMSQLARjICqfbVJyrTlpS6Z664ustoznwQK0cb5cMRseqh/5R1VleTPoTWDZJ2XrW+9g+NBUF7i2nL4D9D+oAwK0S3Lo0rjcv7/kWO6FBSlLe2rhshSD3/NV5HYjWLrN5uFgzmn6pSbm5dSpJ3A0Ee8LbEatnfrEjkOR3ohaVBaIX8hPcalW4WHV0XrIr0wINHLSPZg0O9geOc0GXuny45hkKGkuh/exmGmGbI=
        on_success: change
        on_failure: always
