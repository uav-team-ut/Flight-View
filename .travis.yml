language: node_js
node_js:
    - '8'
    - '7'
    - '6'
sudo: required
dist: trusty
services:
    - docker
addons:
    code_climate:
        repo_token: $CODE_CLIMATE_TOKEN
branches:
    only:
        - master
        - development
        - /^release-.*$/
        - /^hotfix-.*$/
before_install:
    - sudo apt-get install xvfb
install:
    - export DISPLAY=':99.0'
    - Xvfb :99 -screen 0 1024x768x24 > /dev/null 2>&1 &
    - docker pull auvsisuas/interop-server
    - docker images
    - npm install
    - npm install -g mocha
script:
    - npm run test-travis
after_success:
    - npm install -g codeclimate-test-reporter
    - codeclimate-test-reporter < coverage/lcov.info
notifications:
    email: false
    slack:
        rooms:
            - secure: jzS8783UlqWvAMB8145Ia19b/hw6BpXNt/viIJ2A3hiCOlrxA6KOQQv6GYHqjUQKg8idCN3EbiQ+W/v+6yqhGlGd0bkQjKl8PLxiRMKhSYQpZ7TSEyjZ8CcTeQI/pPTU6wjkyrCToY1Yk9JkQKfGIiVCzEfsxNApq3j9/86vME3lMh23zvKNnfTzz6XQSvyuPZcjmMornB7N+jns17Xt2+Yt2R4rKKdxX/DTQ/6oxQ1sxQHFOiJJPTd7uUJ3iBLYq0AGOx6Sprn7luuXhbMJHRelvrxlB4HEGSMFdKn1gdugqeBllE+pa9uW6/xmoH++829vKytS2BWRbhXmxptxadB+WEcXRIWELYk1r7Wp+Y4H/pwE+/i6dOEx1MKK6n+qVAjeskeq1S7PSzoe4A3nnsLFAEThVkC357RMoEKhDsyWvEnshQW7J/LXQNdKcr+WJ+LF4HWinqY8VXEuTsoSonipUDpYm4KQRso8DkxJSk4Vfabi0h9VNxuo9IgXItDO6IOCuKYAfoigPo6eBbfun/4YjzTBgp5qc9Udu/pFW/sk/SWsx1xlE1qfxOtFnGlAWp1TY00S3tgUbJOresTBXqpVxT8t4kFOBW8UmrvlvpecQWcdB1hAaMnr1rqh6E+dMi0ZaJd7tzclwDWz625+0iYIIiwwy5clODhowfpTJW0=
        on_success: change
        on_failure: always
